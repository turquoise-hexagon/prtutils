#!/bin/bash
#
# print package size

files=$(pkginfo -l "$1" 2> /dev/null) || {
    echo "usage : ${0##*/} [package]" >&2
    exit 1
}

# get package size
while read -r cur; do
    ((size += cur))
done < <(
    IFS=$'\n'

    stat -c '%s' -- $(
        while read -r file; do
            [[ $file =~ /$ ]] || echo "/$file"
        done <<< $files
    ) 2> /dev/null
)

# make size human readable
units=(B K M G T)

for ((b = size; b > 1024; b /= 1024, i++)) {
    d=.$((b % 1024 * 10 / 1024))
}

echo "$b$d${units[i]}"
